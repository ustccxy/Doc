## DCL-SLAM

### Abstract

为了在未知环境中执行协作任务，机器人群必须建立一个全局参考框架，并在对环境的共同理解中定位自己。然而，它在现实场景中面临着许多挑战，例如缺乏关于环境的先验信息以及团队成员之间缺乏沟通。这项工作提出了DCL-SLAM，一种前端不可知的全分布式协同LiDAR SLAM框架，用于在未知环境中进行低信息交换的共定位。DCL-SLAM基于点对点通信，采用轻量级LiDAR-Iris描述符进行位置识别，不需要团队之间的完全连接。DCL-SLAM包括三个主要部分:可更换的单机器人前端激光雷达里程计;分布式闭环模块，检测机器人之间的重叠;并结合抑制虚假回环检测，设计了适应分布式位姿图优化器的分布式后端模块。我们将所提出的框架与各种开源激光雷达里程计相结合，以显示其多功能性。所提出的系统在各种规模和环境的基准数据集和现场实验上进行了广泛的评估。实验结果表明，DCL-SLAM系统比其他先进的多机器人激光雷达SLAM系统具有更高的精度和更低的带宽。

### 介绍

(SLAM)是机器人导航的基本能力，特别是在未知和gps拒绝的环境中，并且有大量的文献致力于先进的单机器人SLAM方法[1]-[6]。然而,与单一的机器人系统相比,多机器人系统在自动化、探索不安全区域、智能交通、军事和民用努力等时间敏感应用等时间敏感应用中具有更显著的能力和工作效率。因此, 在过去十年中，基于单机器人SLAM各种机器人集群协同SLAM方法已经得到了研究[7]。C-SLAM目标是将每个机器人的数据结合起来,建立相对的姿态转换和机器人之间的全局地图。

对于机器人群的实际应用来说,C-SLAM仍然是一个开放的问题,由于机器人之间的通信可能是慢的(带宽约束)或不可行的(有限的通信范围),目前正在研究一些挑战。由于LiDAR的各种优势，如高分辨率点云和对各种天气和光照条件的鲁棒性，许多LiDAR C-SLAM方法被提出[8]-[12]。然而，这些系统并不适用于机器人群，特别是在具有通信限制的大规模场景中。此外，许多C-SLAM作品[10]，[12]通过将数据集分成多个部分来评估他们的系统，这并不能代表机器人群体的实际合作。因此，从多个平台收集合成数据[13]在实际场景中进行系统评估是必要的。cSLAM在研究界仍然是一个相对年轻的研究领域，尽管前景非常广阔。

在这种精神上,我们现在的dclp - SLAM,一个完整的分布式协同激光雷达系统,用于机器人群。DCL-SLAM专注于数据高效和弹性的人机交互通信,达到了一致的轨迹估计,有部分姿态测量和间接数据关联。该框架与不同的LiDAR odometry兼容,基于需求和场景,没有额外的工作。每一个机器人在独立和协同地执行单机前端,当队友在通信范围内。为了满足通信约束，集成了一个轻量级全局描述符LiDAR-Iris[14]来描述激光扫描并检测环路闭包，而无需交换额外的原始数据。此外，我们还设计了一种三阶段数据高效的分布式闭环方法来获得机器人之间的相对姿态转换。之后，基于[15]进行离群值抑制，去除假的机器人间闭环，增强鲁棒性。最后，通过两级分布高斯-塞德尔算法对所有采集到的测量数据进行优化(DGS)方法[16]，该方法需要最少的信息交换。我们的框架使用多个多机器人数据集进行评估，包括公共数据集(KITTI)和由三辆无人地面车辆(ugv)收集的校园数据集。此外，还进行了在线现场测试和可扩展性实验。

综上所述，本工作的贡献如下:

一个前端不可知的全分布式协同雷达机器人集群的SLAM框架，该框架支持机器人群向不同区域的快速迁移雷达传感器、平台和场景。

提出了一种高度集成的数据高效的机器人间闭环检测方法，该方法采用三阶段通信pipeline实现了高精度和鲁棒性。

广泛的实验评估，包括性能，可扩展性和现实世界的现场测试，进行了验证所提出的系统。建议系统的自定义数据集和源代码向公众开放。

### 相关工作

多机器人回环检测。通过检测机器人间的闭环来估计机器人之间的相对姿态是一种无需外部定位基础设施就能将机器人轨迹合并在一个共同框架内的有效方法。此外，补偿前端里程计的漂移和提高轨迹估计的精度也是至关重要的。第一个问题是如何有效地检测机器人间的闭环。在[8]、[9]、[17]中，每个机器人生成的局部激光地图直接传输到服务器进行集中地图融合，这对服务器的计算资源要求高，通信性能要求可靠。许多基于特征的可视化C-SLAM[11]，[18] -[23]共享关键帧的二进制描述符(如ORB和BRIEF)，并使用词袋(bow)方法来查找多机器人循环闭包。PairCon-SLAM[11]提出了分布式、在线、实时SLAM算法，在两台个人计算机(pc)上使用LiDAR或RGBD相机构建大尺度场景的密集地图，但不适合机器人群体。此外，[24]采用投影激光雷达强度图像提取ORB特征，使用bow方法进行位置识别。使用BoWs引入关键帧全局描述符，可以快速、健壮地搜索循环闭包。并且减少了系统带宽和后端优化时的计算量，对激光雷达C-SLAM具有一定的参考意义。

一般来说，点云描述符提取分为局部描述符、全局描述符和基于学习的描述符。局部描述符[25]，[26]是从点云中关键点的局部邻域提取的。虽然局部描述子方法由于缺乏描述能力而不适合机器人间的闭环检测场景，但它们可以用于验证假定的闭环和几何验证中的相对姿态估计。提取全局描述符[14]，[27] -[29]从整个点集可以缓解缺乏描述能力的问题。DiSCo-SLAM[12]引入Scan-Context[29]进行机器人间回路闭合，并提出了局部和全局两阶段分布式优化框架。与DiSCo-SLAM相比，考虑到带宽限制和通信范围，我们的方法提出了一种具有三级通信管道的分布式闭环框架，避免了所有原始云和特征云的交换。其次，我们进行了广泛而全面的实验来验证所提出的系统，并将我们的系统应用于一个有9个机器人的大型团队，而DiSCo-SLAM只有3个机器人。近年来，卷积神经网络被用于训练特征描述符[30] -[34]。SegMap[10]为LiDAR提出了一种数据驱动的描述符，用于提取可用于环路检测和地图重建的有意义的特征。FPET-Net[34]引入了特征点提取模块来减小点云的大小并保留数据特征，引入了点变换模块来提取全局描述符。然而，这些基于学习的方法需要大量的训练数据。在我们的工作中，我们采用了一种轻量级的全局描述子LiDAR-Iris，用于快速和鲁棒的分布式闭环检测。它对每个bin的高度信息进行编码，在不进行任何预训练的情况下提取判别特征，并且不进行暴力匹配的旋转不变性。

获得闭环的相对位姿是第二个问题。通常采用3D-3D匹配方法LiDAR SLAM，如ICP[35]和GICP[36]。在分布式系统中，由于通信范围和带宽的限制，如何交换各个机器人上的描述符是一个关键问题。[37]预先将词汇表中的单词分配给每个机器人，并将整个查询发送给候选机器人以检测循环闭包。[38]在完全连接的团队中使用NetVLAD描述符进行了分布式循环关闭的有效数据关联。这些方法需要较少的数据交换，并且可以随团队中机器人数量的增加而很好地扩展，但它们是为全连接系统设计的。[20]，[39]，[40]在机器人交会过程中有效地交换数据，充分利用可用的通信和计算资源。这些方法更适合于机器人群体，特别是在通信范围有限的大规模场景下。

离群值剔除。异常值抑制对姿态估计至关重要，因为不正确的测量可能由感知混叠引起。RANSAC算法[41]广泛应用于LiDAR和visual SLAM，对很大一部分异常值具有鲁棒性。然而，它根据给定的模型来区分内线和离群值。[42]通过考虑测量中的数据相似性和闭环之间的一致性，拒绝不准确的闭环。[15]提出了成对一致测量集最大化(ppcm)来检查每对机器人间环路闭包的一致性，以鲁棒合并多机器人地图，多个多机器人SLAM系统已采用该方法[12]，[20]-[22]来剔除离群值。这项工作结合了RANSAC和PCM，使系统更加健壮。

多机器人姿态图优化。位姿图优化是一种流行的、有效的后端姿态优化方法。集中式PGO方法[17]，[43]在服务器或机器人上收集所有信息，并在全局姿态图上估计所有机器人的轨迹。然而，分布式方法[16]，[44]更适用于多机器人系统中由于带宽限制和通信范围有限，通信能力较差的情况。DDF-SAM[44]提出了一种基于高斯消去的基于地标的分布式轨迹优化方法。[45]提出了一种用于分布式执行黎曼梯度下降的多阶段分布式黎曼共识协议。[16]提出了一种两阶段分布式Gauss-Seidel方法，避免了复杂的记账和重复计数。[46]提出了一种求解分布式PGO的多数化-最小化方法。[47]提出了黎曼块坐标下降(RBCD)解决了位姿图优化问题的秩限制松弛问题，达到了比具有局部网络的DGS更好的性能。分布式C-SLAM方案[20]、[38]因其适用于有限的通信资源而被采用[16]。在这项工作中，我们也使用了DGS方法作为实验的后端。

### DCL-SLAM框架

我们提出的**<font color=red>框架依赖于与自组织无线网络的点对点通信</font>。**当两个机器人交会时，它们共享对环境信息的理解，建立全局参考框架，执行分布式SLAM。并且，在通信范围内没有队友时，每个机器人进行单机器人SLAM，以保证每个机器人的独立性。

在一些现有的C-SLAM系统[10]中，前端和后端模块紧密耦合，难以低成本更换或更新一个改进模块(如里程计、机器人间闭环)。因此， 

#### 单机器人前端

DCL-SLAM框架支持具有各种激光雷达里程计的单机器人前端接口，并兼容不同的激光雷达配置(例如固态和机械激光雷达)、平台(例如地面和空中车辆)和场景(例如室内和室外环境)。

在我们的实现中，采用LIO-SAM[2]作为地面车辆测程的典型示例，采用FAST-LIO2[4]作为飞行器测程的典型示例，以及其他LiDAR测程的典型示例，如LOAM[48]是另一种选择。在对测程估计进行细化后，可以构造LiDAR测程因子Fr_odom (r∈{α， β， γ，···})并将其发送到分布式后端模块。**<font color=red>将相关点云扫描用于机器人内部和机器人之间的闭环。</font>**

为了提高单机器人前端模块的精度，需要一个机器人内部闭环子模块来消除里程漂移。在一些现有的激光雷达里程计(例如，LIO-SAM)，包括回环子模块。因此，很容易提取结果来构造机器人内部的闭环因子$F^{r}_{intra}$，用于位姿分布图优化。此外，我们还在我们的框架中提供了一个内置的机器人内部闭环子模块，仅用于里程计系统(例如FAST-LIO2)，熟悉机器人间闭环模块，无需与其他机器人通信(详见下一小节)。

#### 分布式回环

在我们的框架中，分布式闭环模块在机器人群中执行位置识别以生成相对位姿变换，如图3所示。

此外，检测由自身或群中的其他机器人创建的局部地图之间的重叠部分对于减少其累积漂移并将所有机器人融合成几何上一致的全局地图至关重要。我们的分布式闭环模块包括四个步骤:关键帧选择、描述、搜索和验证。

为了提高计算和通信效率，我们首先在位置和旋转变化比前一帧超过阈值时选择关键帧。在我们的工作中，位置和旋转变化阈值分别为1米和0.2 rad。

此外，我们执行了**<font color=red>一种三阶段分布式闭环检测方法，包括共享每个关键帧的全局描述符，如果找到候选点云，则与位姿共享过滤后的点云，如果验证通过则共享匹配结果。</font>**它可以实现数据高效通信，并且不需要机器人群之间的完全连接。

描述子。LiDAR-Iris。不展开。在每个机器人中，扫描将被局部描述为二值特征图像。如图3所示，一旦机器人β处于机器人α的通信范围内，将机器人β的二值特征图像单独以row keys发送给机器人α(每个关键帧约29kB)。因此，机器人α可以获得所有机器人的二值特征图像的历史数据库。

查找。不展开。最接近满足接受阈值的查询候选者被视为回环候选者，并与机器人β共享。机器人α还将识别位置的特征点云或去畸变云传输给机器人β进行验证(每帧约100kB)。这个阶段提供了一个回环候选，不需要交换原始数据，也不需要完全连接。

验证。在验证阶段，使用RANSAC算法对机器人α的过滤扫描和机器人β的周围子地图进行scan-to-map的匹配，从而验证候选匹配项。如果内点集合足够大，则认为相应的回环成功。利用ICP方法对闭环候选体的相对位姿变换进行了评估。之后，机器人β将机器人间回环的相对位姿变换反馈给机器人β(每关键帧约104B)。一旦找到并共享了机器人间回路因子$F^{r}_{inter}$，两个机器人就会启动下一节所述的分布式位姿图优化。

#### 分布式后端

在我们的DCL-SLAM框架中，分布式后端模块包括两个子模块。第一个子模块，异常值剔除，去除假的机器人间回环。第二个子模块是位姿图优化(PGO)，它构建了一个包含所有因子的全局位姿图来估计机器人群的全局轨迹。后端PGO考虑了三种因素，其中包括里程计因子$F^{r}_{odom}$，机器人内回环因子$F^{r}_{intra}$，机器人间回环因子$F^{r}_{inter}$。这些因子的一般可能性项目是:



其中x = [xα,xβ,xγ，···]是机器人轨迹位姿的集合，zαiβj是机器人α在时刻i和机器人β在时刻j的位姿变换的一般测量模型。



**外点剔除。**分布式外点剔除子模块可抑制因回环查找过程中只匹配特征而导致的机器人间假阳性回环。这些感知混叠可能在机器人轨迹估计中造成相当大的漂移。因此，[15]中的两两一致测量集最大化被引入到外点剔除中，并作为分布式方法实现。PCM通过以下度量来检验机器人间闭环测量值zαjβm和zαiβn对的一致性:

其中，$Z_{α_{i}α_{j}}$为机器人α 中与时间I和j相关的机器人内部位姿变换，$Z_{α_{j}β_{m}}$是机器人间的位姿变换，在机器人α中与时间j有关，在机器人β中与时间m有关，λ为似然阈值。在执行两两一致性检查之后，它通过找到一个最大的团来找到两两一致性测量的最大集合。最后，将最大集合中的回环传递给后端分布式PGO用于进一步的联合优化。

**姿态图优化。**PGO子模块使用里程测量和闭环测量(机器人内部和机器人之间)通过解决最大似然问题来估计机器人的轨迹:

在我们的实现中，采用DGS方法[16]，其中每个机器人使用分布式两阶段高斯-赛德尔方法求解其位姿图。该算法在每个机器人中周期性地、同步地执行，估计机器人轨迹的旋转，然后用优化后的旋转估计出机器人的完整姿态。在此过程中，根据所有连接机器人的优化顺序，将所需的旋转和姿态估计传递给指定机器人。利用这种方法，群中的机器人可以交换最小的信息，避免复杂的簿记和重复计数，并在最优轨迹估计上达成共识。算法1对协同定位过程进行了总结。





### 实验

**<font color=red>UGV依靠通信无线电NexFiMF1400，创建一个自组织无线网络，以提供机器人之间的点对点通信。</font>**

时间同步和标定是实现多传感器定位和地图绘制高性能的关键。对于时间同步，FPGA板(Altera EP4CE10作为外部触发器，周期性地产生脉冲以同步激光雷达、相机和IMU。

标定。棋盘格标定、IMU的内在校准则使用Kalibr[49]工具箱进行。相机IMU联合校准采用Allan标准差。

